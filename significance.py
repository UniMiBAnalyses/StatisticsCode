import ROOT as rt
from math import *

#s = 1,10,100,1000

c1 = rt.TCanvas("sigma1", "", 100, 200, 700, 500)
c10 = rt.TCanvas("sigma10", "", 100, 200, 700, 500)
c100 = rt.TCanvas("sigma100", "", 100, 200, 700, 500)
c1000 = rt.TCanvas("sigma1000", "", 100, 200, 700, 500)

c2 = rt.TCanvas("sigma2", "", 100, 200, 700, 500)

sigma1 = rt.TF1("sigma1","(1.)/sqrt(x)",0.,4e06)
var1 = rt.TF1("var1","sqrt(2)*sqrt(((1.)+x)*log(1+(1.)/x)-(1.))", 0., 4e06)
ratio1 = rt.TF1("ratio1","((1.)/sqrt(x)) / (sqrt(2)*sqrt(((1.)+x)*log(1+(1.)/x)-(1.)))",0.,4e06)

sigma10 = rt.TF1("sigma10","(10.)/sqrt(x)",0.,4e06)
var10 = rt.TF1("var10","sqrt(2)*sqrt(((10.)+x)*log(1+(10.)/x)-(10.))", 0., 4e06)
ratio10 = rt.TF1("ratio10","((10.)/sqrt(x)) / (sqrt(2)*sqrt(((10.)+x)*log(1+(10.)/x)-(10.)))",0.,4e06)

sigma100 = rt.TF1("sigma100","(100.)/sqrt(x)",0.,4e06)
var100 = rt.TF1("var100","sqrt(2)*sqrt(((100.)+x)*log(1+(100.)/x)-(100.))", 0., 4e06)
ratio100 = rt.TF1("ratio100","((100.)/sqrt(x)) / (sqrt(2)*sqrt(((100.)+x)*log(1+(100.)/x)-(100.)))",0.,4e06)

sigma1000 = rt.TF1("sigma1000","(1000.)/sqrt(x)",0.,4e06)
var1000 = rt.TF1("var1000","sqrt(2)*sqrt(((1000.)+x)*log(1+(1000.)/x)-(1000.))", 0., 4e06)
ratio1000 = rt.TF1("ratio1000","((1000.)/sqrt(x)) / (sqrt(2)*sqrt(((1000.)+x)*log(1+(1000.)/x)-(1000.)))",0.,4e06)

sigma2d = rt.TF2("sigma2d", "(y/sqrt(x)) / (sqrt(2)*sqrt((y+x)*log(1+y/x)-y))", 0.,400,0.,400) #y=sig, x=bkg

gr = rt.TGraph()
gr.SetPoint(0,0,0)
gr.SetPoint(1,0,0.0000001)
gr.SetPoint(2,1000000,0)
gr.SetTitle("#Sigma_{1} / #Sigma_{2}")

gr1 = rt.TGraph()
gr1.SetPoint(0,0,0.9)
gr1.SetPoint(1,4e01,0.9)
gr1.SetPoint(2,0.,1.6)
gr1.SetPoint(3,4e01,1.6)
#gr1.SetTitle("s = 1")

gr1b = rt.TGraph()
gr1b.SetPoint(0,0,0)
gr1b.SetPoint(1,4e06,0.8)
gr1b.SetPoint(2,0.,1.)
gr1b.SetPoint(3,4e06,1.)
#gr1b.SetTitle("s = 1")

gr10 = rt.TGraph()
gr10.SetPoint(0,0,0.9)
gr10.SetPoint(1,4e02,0.9)
gr10.SetPoint(2,0.,1.6)
gr10.SetPoint(3,4e02,1.6)
#gr10.SetTitle("s = 10")

gr10b = rt.TGraph()
gr10b.SetPoint(0,0,0)
gr10b.SetPoint(1,4e06,0.8)
gr10b.SetPoint(2,0.,10.)
gr10b.SetPoint(3,4e06,10.)
#gr10b.SetTitle("s = 10")

gr100 = rt.TGraph()
gr100.SetPoint(0,0,0.9)
gr100.SetPoint(1,4e03,0.9)
gr100.SetPoint(2,0.,1.6)
gr100.SetPoint(3,4e03,1.6)
#gr100.SetTitle("s = 100")

gr100b = rt.TGraph()
gr100b.SetPoint(0,0,0)
gr100b.SetPoint(1,4e06,0.8)
gr100b.SetPoint(2,0.,100.)
gr100b.SetPoint(3,4e06,100.)
#gr100b.SetTitle("s = 100")

gr1000 = rt.TGraph()
gr1000.SetPoint(0,0,0.9)
gr1000.SetPoint(1,4e04,0.9)
gr1000.SetPoint(2,0.,1.6)
gr1000.SetPoint(3,4e04,1.6)
#gr1000.SetTitle("s = 1000")

gr1000b = rt.TGraph()
gr1000b.SetPoint(0,0,0)
gr1000b.SetPoint(1,4e06,0.8)
gr1000b.SetPoint(2,0.,1000.)
gr1000b.SetPoint(3,4e06,1000.)
#gr1000b.SetTitle("s = 1000")

sigma1.SetLineColor(2)
sigma1.SetLineWidth(2)
sigma10.SetLineColor(2)
sigma10.SetLineWidth(2)
sigma100.SetLineColor(2)
sigma100.SetLineWidth(2)
sigma1000.SetLineColor(2)
sigma1000.SetLineWidth(2)

var1.SetLineColor(4)
var1.SetLineWidth(2)
var10.SetLineColor(4)
var10.SetLineWidth(2)
var100.SetLineColor(4)
var100.SetLineWidth(2)
var1000.SetLineColor(4)
var1000.SetLineWidth(2)

ratio1.SetLineColor(6)
ratio1.SetLineWidth(4)
ratio10.SetLineColor(6)
ratio10.SetLineWidth(4)
ratio100.SetLineColor(6)
ratio100.SetLineWidth(4)
ratio1000.SetLineColor(6)
ratio1000.SetLineWidth(4)

l1 = rt.TLine(0,1,40,1)
l1.SetLineStyle(7)
l10 = rt.TLine(0,1,400,1)
l10.SetLineStyle(7)
l100 = rt.TLine(0,1,4000,1)
l100.SetLineStyle(7)
l1000 = rt.TLine(0,1,40000,1)
l1000.SetLineStyle(7)

gr1.GetXaxis().SetTitle("b")
gr1.GetYaxis().SetTitle("#Sigma")
gr10.GetXaxis().SetTitle("b")
gr10.GetYaxis().SetTitle("#Sigma")
gr100.GetXaxis().SetTitle("b")
gr100.GetYaxis().SetTitle("#Sigma")
gr1000.GetXaxis().SetTitle("b")
gr1000.GetYaxis().SetTitle("#Sigma")
        
c1.cd()
c1_1 = rt.TPad("sigma1_1", "", 0.02,0.05,0.48,0.95,17,3)
c1_2 = rt.TPad("sigma1_2", "", 0.52,0.05,0.98,0.95,17,3)
c1_1.SetFillColor(0)
c1_2.SetFillColor(0)
c1_1.Draw()
c1_2.Draw()
c1_1.cd()
c1_1.SetLogx()
gr1b.Draw("AP")
sigma1.Draw("L SAME")
var1.Draw("L SAME")
c1_2.cd()
gr1.Draw("AP")
ratio1.SetMaximum(4e01)
ratio1.SetMinimum(0.)
ratio1.Draw("L SAME")
l1.Draw("SAME")
c1.SaveAs("sigma1.png")

c10.cd()
c10_1 = rt.TPad("sigma10_1", "", 0.02,0.05,0.48,0.95,17,3)
c10_2 = rt.TPad("sigma10_2", "", 0.52,0.05,0.98,0.95,17,3)
c10_1.SetFillColor(0)
c10_2.SetFillColor(0)
c10_1.Draw()
c10_2.Draw()
c10_1.cd()
c10_1.SetLogx()
gr10b.Draw("AP")
sigma10.Draw("L SAME")
var10.Draw("L SAME")
c10_2.cd()
gr10.Draw("AP")
ratio10.SetMaximum(4e02)
ratio10.SetMinimum(0.)
ratio10.Draw("L SAME")
l10.Draw("SAME")
c10.SaveAs("sigma10.png")

c100.cd()
c100_1 = rt.TPad("sigma100_1", "", 0.02,0.05,0.48,0.95,17,3)
c100_2 = rt.TPad("sigma100_2", "", 0.52,0.05,0.98,0.95,17,3)
c100_1.SetFillColor(0)
c100_2.SetFillColor(0)
c100_1.Draw()
c100_2.Draw()
c100_1.cd()
c100_1.SetLogx()
sigma100.SetMaximum(4e05)
sigma100.SetMinimum(0.)
gr100b.Draw("AP")
sigma100.Draw("L SAME")
var100.Draw("L SAME")
c100_2.cd()
gr100.Draw("AP")
ratio100.SetMaximum(4e03)
ratio100.SetMinimum(0.)
ratio100.Draw("L SAME")
l100.Draw("SAME")
c100.SaveAs("sigma100.png")

c1000.cd()
c1000_1 = rt.TPad("sigma1000_1", "", 0.02,0.05,0.48,0.95,17,3)
c1000_2 = rt.TPad("sigma1000_2", "", 0.52,0.05,0.98,0.95,17,3)
c1000_1.SetFillColor(0)
c1000_2.SetFillColor(0)
c1000_1.Draw()
c1000_2.Draw()
c1000_1.cd()
c1000_1.SetLogx()
gr1000b.Draw("AP")
sigma1000.Draw("L SAME")
var1000.Draw("L SAME")
c1000_2.cd()
gr1000.Draw("AP")
ratio1000.SetMaximum(4e07)
ratio1000.SetMinimum(0.)
ratio1000.Draw("L SAME")
l1000.Draw("SAME")
c1000.SaveAs("sigma1000.png")

c2.cd()
gr.Draw("AP")
sigma2d.SetContour(10000)
sigma2d.Draw("COLZ2 L SAME")
c2.SaveAs("sigma2d.png")
    

